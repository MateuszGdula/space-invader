!function(e){var t={};function s(i){if(t[i])return t[i].exports;var h=t[i]={i:i,l:!1,exports:{}};return e[i].call(h.exports,h,h.exports,s),h.l=!0,h.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var h in e)s.d(i,h,function(t){return e[t]}.bind(null,h));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=3)}([function(e,t,s){var i=s(1);"string"==typeof i&&(i=[[e.i,i,""]]);var h={insert:"head",singleton:!1};s(2)(i,h);i.locals&&(e.exports=i.locals)},function(e,t,s){},function(e,t,s){"use strict";var i,h={},a=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},n=function(){var e={};return function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[t]=s}return e[t]}}();function r(e,t){for(var s=[],i={},h=0;h<e.length;h++){var a=e[h],n=t.base?a[0]+t.base:a[0],r={css:a[1],media:a[2],sourceMap:a[3]};i[n]?i[n].parts.push(r):s.push(i[n]={id:n,parts:[r]})}return s}function o(e,t){for(var s=0;s<e.length;s++){var i=e[s],a=h[i.id],n=0;if(a){for(a.refs++;n<a.parts.length;n++)a.parts[n](i.parts[n]);for(;n<i.parts.length;n++)a.parts.push(y(i.parts[n],t))}else{for(var r=[];n<i.parts.length;n++)r.push(y(i.parts[n],t));h[i.id]={id:i.id,refs:1,parts:r}}}}function d(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var i=s.nc;i&&(e.attributes.nonce=i)}if(Object.keys(e.attributes).forEach((function(s){t.setAttribute(s,e.attributes[s])})),"function"==typeof e.insert)e.insert(t);else{var h=n(e.insert||"head");if(!h)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");h.appendChild(t)}return t}var l,p=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function c(e,t,s,i){var h=s?"":i.css;if(e.styleSheet)e.styleSheet.cssText=p(t,h);else{var a=document.createTextNode(h),n=e.childNodes;n[t]&&e.removeChild(n[t]),n.length?e.insertBefore(a,n[t]):e.appendChild(a)}}function u(e,t,s){var i=s.css,h=s.media,a=s.sourceMap;if(h&&e.setAttribute("media",h),a&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var m=null,x=0;function y(e,t){var s,i,h;if(t.singleton){var a=x++;s=m||(m=d(t)),i=c.bind(null,s,a,!1),h=c.bind(null,s,a,!0)}else s=d(t),i=u.bind(null,s,t),h=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else h()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a());var s=r(e,t);return o(s,t),function(e){for(var i=[],a=0;a<s.length;a++){var n=s[a],d=h[n.id];d&&(d.refs--,i.push(d))}e&&o(r(e,t),t);for(var l=0;l<i.length;l++){var p=i[l];if(0===p.refs){for(var c=0;c<p.parts.length;c++)p.parts[c]();delete h[p.id]}}}}},function(e,t,s){"use strict";s.r(t);s(0);const i=document.querySelector(".game"),h=i.offsetHeight;i.width=Math.round(1.77*h),i.height=h;const a={ctx:i.getContext("2d"),w:i.width,h:i.height,isMobile:/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)};var n=class{constructor(e,{asset:t,speed:s}){this.ctx=e,this.asset=t,this.speed=s,this.x=0,this.w=SI_GAME.data.w,this.h=SI_GAME.data.h}draw(){this.ctx.beginPath(),this.ctx.drawImage(this.asset,this.x,0,this.w,this.h),this.ctx.drawImage(this.asset,this.x+SI_GAME.data.w,0,this.w,this.h),this.ctx.closePath(),this.x>-1*SI_GAME.data.w?this.x-=this.speed:this.x=0}};class r extends EventTarget{constructor(e,t){super(),this.setVars(e,t),this.addWeapon(SI_GAME.weapons[0]),this.setListeners()}setVars(e,{asset:t,speed:s,shield:i}){this.ctx=e,this.asset=t,this.speed=s,this.shield=i,this.w=.08*SI_GAME.data.w,this.h=.05*SI_GAME.data.h,this.x=10,this.y=SI_GAME.data.h/2,this.alpha=1,this.moveRight=!1,this.moveLeft=!1,this.moveUp=!1,this.moveDown=!1,this.reload=!1,this.weapons=[],this.eqWeapon=null}setListeners(){SI_GAME.data.isMobile?(this.shot=this.shot.bind(this),document.addEventListener("click",this.shot),this.swipesHandler=this.swipesHandler.bind(this),document.addEventListener("touchmove",this.swipesHandler),document.addEventListener("touchstart",e=>{this.touchX=this.x,this.touchY=this.y}),document.addEventListener("touchend",e=>{this.moveUp=this.moveDown=this.moveRight=this.moveLeft=!1})):(this.keyDownHandler=this.keyDownHandler.bind(this),document.addEventListener("keydown",this.keyDownHandler),this.keyUpHandler=this.keyUpHandler.bind(this),document.addEventListener("keyup",this.keyUpHandler))}swipesHandler(e){let t=e.touches[0];t.clientX>this.touchX&&(this.moveRight=!0),t.clientX<this.touchX&&(this.moveLeft=!0),t.clientY<this.touchY&&(this.moveUp=!0),t.clientY>this.touchY&&(this.moveDown=!0),e.touches.length>1&&this.shot(),this.touchX=t.clientX,this.touchY=t.clientY}keyDownHandler(e){("Right"==e.key||"ArrowRight"==e.key)&&(this.moveRight=!0),("Left"==e.key||"ArrowLeft"==e.key)&&(this.moveLeft=!0),("Up"==e.key||"ArrowUp"==e.key)&&(this.moveUp=!0),("Down"==e.key||"ArrowDown"==e.key)&&(this.moveDown=!0)," "===e.key&&this.shot()}keyUpHandler(e){("Right"==e.key||"ArrowRight"==e.key)&&(this.moveRight=!1),("Left"==e.key||"ArrowLeft"==e.key)&&(this.moveLeft=!1),("Up"==e.key||"ArrowUp"==e.key)&&(this.moveUp=!1),("Down"==e.key||"ArrowDown"==e.key)&&(this.moveDown=!1)}addWeapon(e){const t={...e};this.weapons.push(t),this.eqWeapon=t}draw(){this.ctx.beginPath(),this.ctx.globalAlpha=this.alpha,this.ctx.drawImage(this.asset,this.x,this.y,this.w,this.h),this.ctx.globalAlpha=1,this.ctx.closePath(),this.update()}update(){this.shield<=0&&this.shipExplosion(),this.moveRight&&this.x+this.w<SI_GAME.data.w&&(this.x+=this.speed),this.moveLeft&&this.x>0&&(this.x-=this.speed),this.moveDown&&this.y+this.h<SI_GAME.data.h&&(this.y+=this.speed),this.moveUp&&this.y>0&&(this.y-=this.speed),SI_GAME.data.isMobile&&(this.moveUp=this.moveDown=this.moveRight=this.moveLeft=!1)}shipExplosion(){this.asset=SI_GAME.assets.explosion,this.w+=2.4,this.h+=.8,this.alpha-=.03,this.alpha<=0&&this.dispatchEvent(new Event("explosion"))}shot(){if(this.reload)return;let e=new Event("shot");e.x=this.x+this.w,e.y=this.y+Math.round(this.h/2),e.asset=this.eqWeapon.asset,e.speed=this.eqWeapon.speed,e.dmg=this.eqWeapon.damage,e.owner="p1",this.dispatchEvent(e),this.reload=!0,setTimeout(()=>this.reload=!1,this.eqWeapon.reloadTime)}}var o=r;class d extends EventTarget{constructor(e,t,s,i,h,a,n){super(),this.setVars(e,t,s,i,h,a,n)}setVars(e,t,s,i,h,a,n){this.ctx=e,this.asset=t,this.w=.02*SI_GAME.data.w,this.h=.01*SI_GAME.data.h,this.x=s,this.y=i,this.speed=h,this.dmg=a,this.owner=n}draw(){this.ctx.beginPath(),this.ctx.drawImage(this.asset,this.x,this.y),this.ctx.closePath(),this.update()}update(){if(this.x+=this.speed,this.x+this.w>SI_GAME.data.w||this.x<0||this.y+this.h>SI_GAME.data.h||this.y<0){let e=new Event("remove");this.dispatchEvent(e)}}}var l=d;class p extends EventTarget{constructor(e,t,s,i){super(),this.setVars(e,t,s,i)}setVars(e,{asset:t,speed:s,shield:i,weapon:h,reward:a},n,r){this.ctx=e,this.asset=t,this.speed=s-Math.random()/2,this.shield=i,this.w=.08*SI_GAME.data.w,this.h=.05*SI_GAME.data.h,this.x=SI_GAME.data.w,this.y=1+Math.floor(Math.random()*(SI_GAME.data.h-this.h)),this.target=n,this.chaser=r,this.reload=!1,this.weapon=h,this.reward=a}draw(){this.ctx.beginPath(),this.ctx.drawImage(this.asset,this.x,this.y,this.w,this.h),this.ctx.closePath(),this.update()}update(){this.shield<=0&&this.shipExplosion(),this.x-=this.speed,this.chaser&&this.target.y+this.target.h/2>this.y+this.h/2?this.y+=this.speed/2:this.chaser&&(this.y-=this.speed/2),this.target.y<this.y+this.h/2&&this.target.y+this.target.h>this.y+this.h/2&&this.target.x+this.target.w<this.x&&this.shot()}shipExplosion(){let e=new Event("explosion");e.x=this.x,e.y=this.y,e.w=this.w,e.h=this.h,this.dispatchEvent(e)}shot(){if(this.reload)return;let e=new Event("shot");e.x=this.x,e.y=this.y+Math.round(this.h/2),e.asset=this.weapon.asset,e.speed=-1*this.weapon.speed,e.dmg=this.weapon.damage,e.owner="npc",this.dispatchEvent(e),this.reload=!0,setTimeout(()=>this.reload=!1,this.weapon.reloadTime)}}var c=p;class u extends EventTarget{constructor(e,t,s,i,h){super(),this.ctx=e,this.w=i,this.h=h,this.x=t,this.y=s,this.asset=SI_GAME.assets.explosion,this.updateCouter=0}draw(){this.ctx.beginPath(),this.ctx.drawImage(this.asset,this.x,this.y,this.w,this.h),this.ctx.closePath(),this.update()}update(){this.w*=1.015,this.h*=1.015,30===this.updateCouter?this.dispatchEvent(new Event("remove")):this.updateCouter++}}var m=u;class x extends EventTarget{constructor(e,t){super(),this.setVars(e,t),this.createContent()}setVars(e,{asset:t,speed:s,type:i}){this.ctx=e,this.asset=t,this.speed=s,this.type=i,this.w=.04*SI_GAME.data.w,this.h=.04*SI_GAME.data.h,this.x=SI_GAME.data.w,this.y=1+Math.floor(Math.random()*(SI_GAME.data.h-this.h)),this.content={}}createContent(){"shield"===this.type&&(this.content={shield:10+Math.round(30*Math.random())}),"weapon"===this.type&&(this.content={weapon:SI_GAME.weapons[1]})}draw(){this.ctx.beginPath(),this.ctx.drawImage(this.asset,this.x,this.y,this.w,this.h),this.ctx.closePath(),this.update()}update(){if(this.x-=this.speed,this.x+this.w<0){let e=new Event("remove");this.dispatchEvent(e)}}}var y=x;var w={level1:{10:{type:"box",content:"shield"},15:{type:"box",content:"weapon"},2:{type:"enemy",index:0,number:1,chaser:!0},7:{type:"enemy",index:0,number:2,chaser:!1},11:{type:"enemy",index:1,number:1,chaser:!0},12:{type:"enemy",index:2,number:1,chaser:!0},16:{type:"enemy",index:0,number:2,chaser:!0},19:{type:"enemy",index:0,number:1,chaser:!1},25:{type:"enemy",index:1,number:2,chaser:!1},27:{type:"enemy",index:0,number:2,chaser:!0},31:{type:"enemy",index:2,number:1,chaser:!0},32:{type:"enemy",index:0,number:1,chaser:!1},36:{type:"enemy",index:0,number:2,chaser:!0},41:{type:"enemy",index:2,number:2,chaser:!1},43:{type:"enemy",index:0,number:1,chaser:!0},46:{type:"enemy",index:0,number:1,chaser:!1},50:{type:"enemy",index:1,number:2,chaser:!1},55:{type:"enemy",index:0,number:1,chaser:!0},59:{type:"enemy",index:0,number:1,chaser:!0},60:{type:"enemy",index:0,number:1,chaser:!1}}};var g=class{constructor(){this.setVars(),this.setListeners()}setVars(){this.ctx=SI_GAME.data.ctx,this.bg=new n(this.ctx,SI_GAME.objects.background),this.ship=new o(this.ctx,SI_GAME.objects.playerShip),this.aliens=[],this.explosions=[],this.missles=[],this.boxes=[],this.menu=document.querySelector(".menu"),this.newGameBtn=document.querySelector(".menu__new-game"),this.resumeBtn=document.querySelector(".menu__resume"),this.optionsBtn=document.querySelector(".menu__options"),this.exitBtn=document.querySelector(".menu__exit"),this.timerInterval=null,this.playState=!1,this.timer=0,this.score=0,this.textWeaponX=20,this.textWeaponY=SI_GAME.data.h-20,this.textShieldX=20,this.textShieldY=SI_GAME.data.h-40,this.textScoreX=20,this.textScoreY=SI_GAME.data.h-60}setListeners(){this.handleShot=this.handleShot.bind(this),this.ship.addEventListener("shot",this.handleShot),this.handlePlayerExplosion=this.handlePlayerExplosion.bind(this),this.ship.addEventListener("explosion",this.handlePlayerExplosion),this.newGameBtn.addEventListener("click",e=>{this.timerInterval&&this.reset(),SI_GAME.data.isMobile&&(document.querySelector("main").requestFullscreen(),screen.orientation.lock("landscape")),this.play(w.level1),this.menu.classList.toggle("open")}),this.resumeBtn.addEventListener("click",e=>{this.resume(),this.menu.classList.toggle("open")}),this.toggleMenuHandler=this.toggleMenuHandler.bind(this),document.addEventListener("keydown",this.toggleMenuHandler)}toggleMenuHandler(e){27===e.keyCode&&(this.playState?this.pause():this.resume(),this.menu.classList.toggle("open"))}play(e){this.playState=!0,this.timerInterval=setInterval(()=>{if(this.playState){if(e[this.timer])switch(e[this.timer].type){case"enemy":const{index:t,number:s,chaser:i}=e[this.timer];for(let e=0;e<s;e++){let e=new c(this.ctx,SI_GAME.objects.alienShips[t],this.ship,i);e.addEventListener("shot",this.handleShot.bind(this)),e.addEventListener("explosion",this.handleAlienExplosion.bind(this)),this.aliens.push(e)}break;case"box":const{content:h}=e[this.timer];let a=new y(this.ctx,SI_GAME.objects[h]);a.addEventListener("remove",e=>this.boxes.splice(this.boxes.indexOf(e.target),1)),this.boxes.push(a)}this.timer++}},1e3),this.drawFrame()}pause(){this.playState=!1}resume(){this.playState=!0,this.drawFrame()}reset(){location.reload()}drawFrame(){this.ctx.clearRect(0,0,SI_GAME.data.w,SI_GAME.data.h),this.bg.draw(),this.ship.draw(),this.missles.forEach(e=>e.draw()),this.aliens.forEach(e=>e.draw()),this.explosions.forEach(e=>e.draw()),this.boxes.forEach(e=>e.draw()),this.drawStatus(),this.detectColisions(),this.playState&&requestAnimationFrame(()=>this.drawFrame())}drawStatus(){this.ctx.beginPath(),this.ctx.font="18px Arial",this.ctx.fillStyle="#ffffff",this.ctx.fillText(`Shield: ${Math.max(0,this.ship.shield)}%`,this.textShieldX,this.textShieldY),this.ctx.fillText(`Weapon: ${this.ship.eqWeapon.name}`,this.textWeaponX,this.textWeaponY),this.ctx.fillText(`Score: ${this.score}`,this.textScoreX,this.textScoreY),this.ctx.closePath()}handleShot(e){let t=new l(this.ctx,e.asset,e.x,e.y,e.speed,e.dmg,e.owner);this.missles.push(t);let s=e=>{this.missles.splice(this.missles.indexOf(t),1),t.removeEventListener("remove",s)};t.addEventListener("remove",s)}handlePlayerExplosion(e){console.log("game over")}handleAlienExplosion(e){let t=new m(this.ctx,e.x,e.y,e.w,e.h);t.addEventListener("remove",e=>this.explosions.splice(this.explosions.indexOf(e.target),1)),this.explosions.push(t),console.log(this.explosions),this.aliens.splice(this.aliens.indexOf(e.target),1),this.score+=e.target.reward}detectColisions(){this.missles.forEach((e,t)=>{"npc"===e.owner&&e.x<this.ship.x+this.ship.w&&e.x>this.ship.x&&e.y<this.ship.y+this.ship.h&&e.y>this.ship.y?(this.ship.shield-=e.dmg,this.missles.splice(t,1)):"p1"===e.owner&&this.aliens.forEach((s,i)=>{e.x+e.w>s.x&&e.x<s.x+s.w&&e.y+e.h>s.y&&e.y<s.y+s.h&&(s.shield-=e.dmg,this.missles.splice(t,1))})}),this.boxes.forEach((e,t)=>{e.x<this.ship.x+this.ship.w&&e.x>this.ship.x&&e.y<this.ship.y+this.ship.h&&e.y>this.ship.y&&("shield"===e.type&&(this.ship.shield=Math.min(this.ship.shield+e.content.shield,100)),"weapon"===e.type&&this.ship.addWeapon(e.content.weapon),this.boxes.splice(t,1))})}};(function(e){return new Promise((t,s)=>{let i=Object.keys(e).length;const h={};for(let s in e)h[s]=new Image,h[s].onload=()=>{i--,0===i&&t(h)},h[s].src=e[s]})})({bg:"./assets/bg.png",ship:"./assets/ship.png",missle1:"./assets/missle1.png",missle2:"./assets/missle2.png",alien1:"./assets/ship_a1.png",alien2:"./assets/ship_a2.png",alien3:"./assets/ship_a3.png",missle_a1:"./assets/missle_a1.png",missle_a2:"./assets/missle_a2.png",missle_a3:"./assets/missle_a3.png",explosion:"./assets/explo.png",shield:"./assets/shieldbox.png",weapon:"./assets/weaponbox.png"}).then(e=>{window.SI_GAME={},SI_GAME.assets=e,SI_GAME.data=a,SI_GAME.objects=(e=>({background:{asset:e.bg,speed:.5},playerShip:{asset:e.ship,speed:2,shield:100},alienShips:[{asset:e.alien1,speed:1.2,shield:100,weapon:{name:"Blaster WTF-30",asset:e.missle_a1,damage:10,speed:3,reloadTime:1e3},reward:100},{asset:e.alien2,speed:1,shield:200,weapon:{name:"Rocket Launcher WTF-30",asset:e.missle_a2,damage:20,speed:1.8,reloadTime:4e3},reward:300},{asset:e.alien3,speed:1.5,shield:40,weapon:{name:"Laser Blaster XYZ123",asset:e.missle_a3,damage:5,speed:4,reloadTime:4e3},reward:150}],shield:{asset:e.shield,speed:4,type:"shield"},weapon:{asset:e.weapon,speed:3,type:"weapon"}}))(e),SI_GAME.weapons=(e=>[{name:"Blaster WTF-40",asset:e.missle1,damage:20,speed:4,reloadTime:100,charges:-1},{name:"Plasma Blaster BB1k",asset:e.missle2,damage:35,speed:9,reloadTime:180,charges:-1}])(e),SI_GAME.gameInstance=new g})}]);