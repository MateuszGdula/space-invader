!function(e){var t={};function s(i){if(t[i])return t[i].exports;var h=t[i]={i:i,l:!1,exports:{}};return e[i].call(h.exports,h,h.exports,s),h.l=!0,h.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var h in e)s.d(i,h,function(t){return e[t]}.bind(null,h));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=3)}([function(e,t,s){var i=s(1);"string"==typeof i&&(i=[[e.i,i,""]]);var h={insert:"head",singleton:!1};s(2)(i,h);i.locals&&(e.exports=i.locals)},function(e,t,s){},function(e,t,s){"use strict";var i,h={},n=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},a=function(){var e={};return function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[t]=s}return e[t]}}();function r(e,t){for(var s=[],i={},h=0;h<e.length;h++){var n=e[h],a=t.base?n[0]+t.base:n[0],r={css:n[1],media:n[2],sourceMap:n[3]};i[a]?i[a].parts.push(r):s.push(i[a]={id:a,parts:[r]})}return s}function o(e,t){for(var s=0;s<e.length;s++){var i=e[s],n=h[i.id],a=0;if(n){for(n.refs++;a<n.parts.length;a++)n.parts[a](i.parts[a]);for(;a<i.parts.length;a++)n.parts.push(x(i.parts[a],t))}else{for(var r=[];a<i.parts.length;a++)r.push(x(i.parts[a],t));h[i.id]={id:i.id,refs:1,parts:r}}}}function l(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var i=s.nc;i&&(e.attributes.nonce=i)}if(Object.keys(e.attributes).forEach((function(s){t.setAttribute(s,e.attributes[s])})),"function"==typeof e.insert)e.insert(t);else{var h=a(e.insert||"head");if(!h)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");h.appendChild(t)}return t}var d,p=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function c(e,t,s,i){var h=s?"":i.css;if(e.styleSheet)e.styleSheet.cssText=p(t,h);else{var n=document.createTextNode(h),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(n,a[t]):e.appendChild(n)}}function u(e,t,s){var i=s.css,h=s.media,n=s.sourceMap;if(h&&e.setAttribute("media",h),n&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var m=null,y=0;function x(e,t){var s,i,h;if(t.singleton){var n=y++;s=m||(m=l(t)),i=c.bind(null,s,n,!1),h=c.bind(null,s,n,!0)}else s=l(t),i=u.bind(null,s,t),h=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else h()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=n());var s=r(e,t);return o(s,t),function(e){for(var i=[],n=0;n<s.length;n++){var a=s[n],l=h[a.id];l&&(l.refs--,i.push(l))}e&&o(r(e,t),t);for(var d=0;d<i.length;d++){var p=i[d];if(0===p.refs){for(var c=0;c<p.parts.length;c++)p.parts[c]();delete h[p.id]}}}}},function(e,t,s){"use strict";s.r(t);s(0);let i=document.querySelector(".game");const h={ctx:i.getContext("2d"),w:i.width,h:i.height};var n=class{constructor(e,{asset:t,speed:s}){this.ctx=e,this.asset=t,this.speed=s,this.x=0}draw(){this.ctx.beginPath(),this.ctx.drawImage(this.asset,this.x,0),this.ctx.drawImage(this.asset,this.x+SI_GAME.data.w,0),this.ctx.closePath(),this.x>-1*SI_GAME.data.w?this.x-=this.speed:this.x=0}};class a extends EventTarget{constructor(e,t){super(),this.setVars(e,t),this.addWeapon(SI_GAME.weapons[0]),this.setListeners()}setVars(e,{asset:t,speed:s,health:i}){this.ctx=e,this.asset=t,this.speed=s,this.health=i,this.w=100,this.h=33,this.x=10,this.y=SI_GAME.data.h/2,this.alpha=1,this.rightPressed=!1,this.leftPressed=!1,this.upPressed=!1,this.downPressed=!1,this.reload=!1,this.weapons=[],this.eqWeapon=null}setListeners(){this.keyDownHandler=this.keyDownHandler.bind(this),document.addEventListener("keydown",this.keyDownHandler),this.keyUpHandler=this.keyUpHandler.bind(this),document.addEventListener("keyup",this.keyUpHandler)}keyDownHandler(e){("Right"==e.key||"ArrowRight"==e.key)&&(this.rightPressed=!0),("Left"==e.key||"ArrowLeft"==e.key)&&(this.leftPressed=!0),("Up"==e.key||"ArrowUp"==e.key)&&(this.upPressed=!0),("Down"==e.key||"ArrowDown"==e.key)&&(this.downPressed=!0)," "===e.key&&this.shot()}keyUpHandler(e){("Right"==e.key||"ArrowRight"==e.key)&&(this.rightPressed=!1),("Left"==e.key||"ArrowLeft"==e.key)&&(this.leftPressed=!1),("Up"==e.key||"ArrowUp"==e.key)&&(this.upPressed=!1),("Down"==e.key||"ArrowDown"==e.key)&&(this.downPressed=!1)}addWeapon(e){const t={...e};this.weapons.push(t),this.eqWeapon=t}draw(){this.ctx.beginPath(),this.ctx.globalAlpha=this.alpha,this.ctx.drawImage(this.asset,this.x,this.y,this.w,this.h),this.ctx.globalAlpha=1,this.ctx.closePath(),this.update()}update(){this.health<=0&&this.shipExplosion(),this.rightPressed&&this.x+this.w<SI_GAME.data.w&&(this.x+=this.speed),this.leftPressed&&this.x>0&&(this.x-=this.speed),this.downPressed&&this.y+this.h<SI_GAME.data.h&&(this.y+=this.speed),this.upPressed&&this.y>0&&(this.y-=this.speed)}shipExplosion(){this.asset=SI_GAME.assets.explosion,this.w+=2.4,this.h+=.8,this.alpha-=.03,this.alpha<=0&&this.dispatchEvent(new Event("explosion"))}shot(){if(this.reload)return;let e=new Event("shot");e.x=this.x+this.w,e.y=this.y+Math.round(this.h/2),e.asset=this.eqWeapon.asset,e.speed=this.eqWeapon.speed,e.dmg=this.eqWeapon.damage,e.owner="p1",this.dispatchEvent(e),this.reload=!0,console.log(e.x,e.y),setTimeout(()=>this.reload=!1,this.eqWeapon.reloadTime)}}var r=a;class o extends EventTarget{constructor(e,t,s,i,h,n,a){super(),this.setVars(e,t,s,i,h,n,a)}setVars(e,t,s,i,h,n,a){this.ctx=e,this.img=t,this.x=s,this.y=i,this.speed=h,this.dmg=n,this.owner=a,this.w=13,this.h=5}draw(){this.ctx.beginPath(),this.ctx.drawImage(this.img,this.x,this.y),this.ctx.closePath(),this.update()}update(){if(this.x+=this.speed,this.x+this.w>SI_GAME.data.w||this.x<0||this.y+this.h>SI_GAME.data.h||this.y<0){let e=new Event("remove");this.dispatchEvent(e)}}}var l=o;class d extends EventTarget{constructor(e,t,s,i){super(),this.setVars(e,t,s,i)}setVars(e,{asset:t,speed:s,health:i,weapon:h},n,a){this.ctx=e,this.asset=t,this.speed=s-Math.random()/2,this.health=i,this.w=100,this.h=33,this.x=SI_GAME.data.w,this.y=SI_GAME.data.h/2,this.y=1+Math.floor(Math.random()*(SI_GAME.data.h-this.h)),this.target=n,this.chaser=a,this.alpha=1,this.reload=!1,this.weapon=h}draw(){this.ctx.beginPath(),this.ctx.globalAlpha=this.alpha,this.ctx.drawImage(this.asset,this.x,this.y,this.w,this.h),this.ctx.globalAlpha=1,this.ctx.closePath(),this.update()}update(){this.health<=0&&this.shipExplosion(),this.x-=this.speed,this.chaser&&this.target.y+this.target.h/2>this.y+this.h/2?this.y+=this.speed/2:this.chaser&&(this.y-=this.speed/2),this.target.y<this.y+this.h/2&&this.target.y+this.target.h>this.y+this.h/2&&this.target.x+this.target.w<this.x&&this.shot()}shipExplosion(){this.asset=SI_GAME.assets.explosion,this.w+=2.4,this.h+=.8,this.alpha-=.03,this.alpha<=0&&this.dispatchEvent(new Event("explosion"))}shot(){if(this.reload)return;let e=new Event("shot");e.x=this.x,e.y=this.y+Math.round(this.h/2),e.asset=this.weapon.asset,e.speed=-1*this.weapon.speed,e.dmg=this.weapon.damage,e.owner="npc",this.dispatchEvent(e),this.reload=!0,setTimeout(()=>this.reload=!1,this.weapon.reloadTime)}}var p=d;var c={level1:{2:{type:"enemy",index:0,number:1,chaser:!0},7:{type:"enemy",index:0,number:2,chaser:!1},11:{type:"enemy",index:0,number:1,chaser:!0},12:{type:"enemy",index:0,number:1,chaser:!0},16:{type:"enemy",index:0,number:2,chaser:!0},19:{type:"enemy",index:0,number:1,chaser:!1},25:{type:"enemy",index:0,number:2,chaser:!1},27:{type:"enemy",index:0,number:2,chaser:!0},31:{type:"enemy",index:0,number:1,chaser:!0},32:{type:"enemy",index:0,number:1,chaser:!1},36:{type:"enemy",index:0,number:2,chaser:!0},41:{type:"enemy",index:0,number:2,chaser:!1},43:{type:"enemy",index:0,number:1,chaser:!0},46:{type:"enemy",index:0,number:1,chaser:!1},50:{type:"enemy",index:0,number:2,chaser:!1},55:{type:"enemy",index:0,number:1,chaser:!0},59:{type:"enemy",index:0,number:1,chaser:!0},60:{type:"enemy",index:0,number:1,chaser:!1}}};var u=class{constructor(){this.setVars(),this.setListeners()}setVars(){this.ctx=SI_GAME.data.ctx,this.bg=new n(this.ctx,SI_GAME.objects.background),this.ship=new r(this.ctx,SI_GAME.objects.playerShip),this.aliens=[],this.missles=[],this.score=0,this.timer=0,this.menu=document.querySelector(".menu"),this.newGameBtn=document.querySelector(".menu__new-game"),this.resumeBtn=document.querySelector(".menu__resume"),this.optionsBtn=document.querySelector(".menu__options"),this.exitBtn=document.querySelector(".menu__exit"),this.timerInterval=null,this.playState=!1}setListeners(){this.handleShot=this.handleShot.bind(this),this.ship.addEventListener("shot",this.handleShot),this.handlePlayerExplosion=this.handlePlayerExplosion.bind(this),this.ship.addEventListener("explosion",this.handlePlayerExplosion),this.newGameBtn.addEventListener("click",e=>{this.timerInterval&&this.reset(),this.start(c.level1),this.menu.classList.toggle("open")}),this.resumeBtn.addEventListener("click",e=>{this.resume(),this.menu.classList.toggle("open")}),this.toggleMenuHandler=this.toggleMenuHandler.bind(this),document.addEventListener("keydown",this.toggleMenuHandler)}toggleMenuHandler(e){27===e.keyCode&&(this.playState?this.pause():this.resume(),this.menu.classList.toggle("open"))}start(e){this.playState=!0,this.timerInterval=setInterval(()=>{if(this.playState){if(e[this.timer]){const{type:t,index:s,number:i,chaser:h}=e[this.timer];switch(t){case"enemy":for(let e=0;e<i;e++){let e=new p(this.ctx,SI_GAME.objects.alienShips[s],this.ship,h);e.addEventListener("shot",this.handleShot.bind(this)),e.addEventListener("explosion",this.handleAlienExplosion.bind(this)),this.aliens.push(e)}}}this.timer++}},1e3),this.drawFrame()}pause(){this.playState=!1}resume(){this.playState=!0,this.drawFrame()}reset(){location.reload()}drawFrame(){this.ctx.clearRect(0,0,SI_GAME.data.w,SI_GAME.data.h),this.bg.draw(),this.ship.draw(),this.missles.forEach(e=>e.draw()),this.aliens.forEach(e=>e.draw()),this.detectColisions(),this.playState&&requestAnimationFrame(()=>this.drawFrame())}handleShot(e){let t=new l(this.ctx,e.asset,e.x,e.y,e.speed,e.dmg,e.owner);this.missles.push(t);let s=e=>{this.missles.splice(this.missles.indexOf(t),1),t.removeEventListener("remove",s)};t.addEventListener("remove",s)}handlePlayerExplosion(e){console.log("game over")}handleAlienExplosion(e){this.aliens.splice(this.aliens.indexOf(e.target),1)}detectColisions(){this.missles.forEach((e,t)=>{"npc"===e.owner&&e.x<this.ship.x+this.ship.w&&e.x>this.ship.x&&e.y<this.ship.y+this.ship.h&&e.y>this.ship.y?(this.ship.health-=e.dmg,this.missles.splice(t,1)):"p1"===e.owner&&this.aliens.forEach((s,i)=>{e.x+e.w>s.x&&e.x<s.x+s.w&&e.y+e.h>s.y&&e.y<s.y+s.h&&(s.health-=e.dmg,this.missles.splice(t,1))})})}};(function(e){return new Promise((t,s)=>{let i=Object.keys(e).length;const h={};for(let s in e)h[s]=new Image,h[s].onload=()=>{i--,0===i&&t(h)},h[s].src=e[s]})})({bg:"./assets/bg.png",ship:"./assets/ship.png",missle1:"./assets/missle1.png",alien1:"./assets/ship_a1.png",missle_a1:"./assets/missle_a1.png",explosion:"./assets/explo.png"}).then(e=>{window.SI_GAME={},SI_GAME.assets=e,SI_GAME.data=h,SI_GAME.objects=(e=>({background:{asset:e.bg,speed:.5},playerShip:{asset:e.ship,speed:2,health:100},alienShips:[{asset:e.alien1,speed:1.2,health:100,weapon:{name:"Blaster WTF-30",asset:e.missle_a1,damage:10,speed:3,reloadTime:1e3}}]}))(e),SI_GAME.weapons=(e=>[{name:"Blaster WTF-40",asset:e.missle1,damage:20,speed:4,reloadTime:100,charges:-1}])(e),SI_GAME.gameInstance=new u})}]);